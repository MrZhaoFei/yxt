<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.system.mapper.self.SelfTestAnswerMapper" >

  <delete id="delete" parameterType="org.system.entity.self.SelfTestAnswer" >
    delete from self_test_answer
   <!--  where id = #{id} -->
    <where>
       <if test="id!=null">
        id=#{id}
       </if>
       <if test="questionId!=null">
       and question_id = #{questionId}
       </if>
    </where>
  </delete>
  <insert id="insert" parameterType="org.system.entity.self.SelfTestAnswer" >
    insert into self_test_answer ( question_id, answer, 
      score)
    values ( #{questionId,jdbcType=INTEGER}, #{answer,jdbcType=VARCHAR}, 
      #{score,jdbcType=INTEGER})
  </insert>
  <update id="update" parameterType="org.system.entity.self.SelfTestAnswer" >
    update self_test_answer set id=#{id}
    <if test="questionId !=null">
    	  ,question_id = #{questionId}
    </if>
    <if test="answer !=null and answer!=''">
    	  ,answer = #{answer}
    </if>
    <if test="score !=null">
    	  ,score = #{score}
    </if>
    where id = #{id}
  </update>
  <select id="queryOne" resultType="map" parameterType="org.system.entity.self.SelfTestAnswer" >
    select id, question_id questionId, answer, score
    from self_test_answer
    where id = #{id}
  </select>
  <select id="queryAll" resultType="map" parameterType="org.system.entity.self.SelfTestAnswer">
    select id, question_id questionId, answer, score
    from self_test_answer 
    <where>
    	<if test="id !=null">
    		id =#{id}
    	</if>
    	<if test="questionId !=null">
    		and question_id =#{questionId}
    	</if>
    	<if test="answer !=null and answer !=''">
    		and answer like CONCAT(CONCAT('%', #{answer}), '%') 
    	</if>
    	<if test="score !=null ">
    		and score =#{score}
    	</if>
    </where>
  </select>
    <!-- 检查唯一性 -->
  <select id="checkExists" parameterType="org.system.entity.self.SelfTestAnswer" resultType="map">
      select id, question_id questionId, answer, score
      from self_test_answer  where question_id=#{questionId} and answer=#{answer}
  </select>
  
</mapper>