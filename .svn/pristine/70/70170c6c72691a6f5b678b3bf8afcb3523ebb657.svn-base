<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.system.mapper.hospital.HospitalMapper" >

  <!-- 删除 -->
  <delete id="delete" parameterType="org.system.entity.hospital.Hospital" >
    delete from hospital
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <!-- 添加 -->
  <insert id="insert" parameterType="org.system.entity.hospital.Hospital" >
    insert into hospital (id, code_value, name, 
      state, type, address, 
      telephone, website, picture, 
      address_id, longitude, latitude, 
      contract_num_prefix, contract_doc_id, remark
      )
    values (#{id,jdbcType=INTEGER}, #{codeValue,jdbcType=VARCHAR}, #{name,jdbcType=VARCHAR}, 
      #{state,jdbcType=INTEGER}, #{type,jdbcType=INTEGER}, #{address,jdbcType=VARCHAR}, 
      #{telephone,jdbcType=VARCHAR}, #{website,jdbcType=VARCHAR}, #{picture,jdbcType=VARCHAR}, 
      #{addressId,jdbcType=INTEGER}, #{longitude,jdbcType=DOUBLE}, #{latitude,jdbcType=DOUBLE}, 
      #{contractNumPrefix,jdbcType=VARCHAR}, #{contractDocId,jdbcType=INTEGER}, #{remark,jdbcType=LONGVARCHAR}
      )
  </insert>
  <!-- 修改 -->
  <update id="update" parameterType="org.system.entity.hospital.Hospital" >
    update hospital
    set code_value = #{codeValue,jdbcType=VARCHAR},
      name = #{name,jdbcType=VARCHAR},
      state = #{state,jdbcType=INTEGER},
      type = #{type,jdbcType=INTEGER},
      address = #{address,jdbcType=VARCHAR},
      telephone = #{telephone,jdbcType=VARCHAR},
      website = #{website,jdbcType=VARCHAR},
      picture = #{picture,jdbcType=VARCHAR},
      address_id = #{addressId,jdbcType=INTEGER},
      longitude = #{longitude,jdbcType=DOUBLE},
      latitude = #{latitude,jdbcType=DOUBLE},
      contract_num_prefix = #{contractNumPrefix,jdbcType=VARCHAR},
      contract_doc_id = #{contractDocId,jdbcType=INTEGER},
      remark = #{remark,jdbcType=LONGVARCHAR}
    where id = #{id,jdbcType=INTEGER}
  </update>
  <!-- 详情 -->
  <select id="queryOne" resultType="map" parameterType="org.system.entity.hospital.Hospital" >
    select h.id, h.code_value codeValue,fn_print_sys_code_result(h.code_value,';','CV02.01.101') codeValueName, h.`name`, 
    h.state, h.type, h.address, h.telephone, h.website, h.picture, h.address_id addressId, 
    h.longitude, h.latitude, h.contract_num_prefix contractNumPrefix, h.contract_doc_id contractDocId, h.remark
    from hospital h
    left join address a on a.id=h.address_id
    where h.id = #{id}
  </select>
  <!-- 查询所有 -->
  <select id="queryAll" resultType="map" parameterType="org.system.entity.hospital.Hospital">
    select h.id, h.code_value codeValue,fn_print_sys_code_result(h.code_value,';','CV02.01.101') codeValueName, h.`name`, 
    h.state, h.type, h.address, h.telephone, h.website, h.picture, h.address_id addressId, 
    h.longitude, h.latitude, h.contract_num_prefix contractNumPrefix, h.contract_doc_id contractDocId, h.remark
    from hospital h
    left join address a on a.id=h.address_id
   	<where>
   		<if test="addressId !=null ">
   			h.address_id=#{addressId}
   		</if>
   		<if test="type !=null ">
   			and h.type=#{type}
   		</if>
   		<if test="types!=null ">
   			and h.type in 
   			<foreach collection="types" item="item" open="(" close=")" separator=",">
   				'${item}'
   			</foreach>
   		</if>
   		<if test="name !=null and name !=''">
   			and h.`name` like CONCAT(CONCAT('%', #{name}), '%')
   		</if>
   		<if test="addressList !=null">
	   			and a.code_value in 
   			<foreach collection="addressList" item="item" open="(" close=")" separator=",">
   				'${item}'
   			</foreach>
   		</if>
   	</where>
  </select>
</mapper>