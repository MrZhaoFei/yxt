<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.system.mapper.user.healthinfo.HealthInfoMapper" >
  
  <delete id="delete" parameterType="org.system.entity.user.healthinfo.HealthInfo" >
    delete from health_info
    where id = #{id}
  </delete>
  <insert id="insert" parameterType="org.system.entity.user.healthinfo.HealthInfo" useGeneratedKeys="true" keyProperty="id" >
    insert into health_info (user_id, yljgbm, 
      jkdabh, yljgmc, zjlx, 
      zjhm, jmjkkh, xm, xbbm, 
      jmlxbm, hyzkbm, csrq, mzbm, 
      gjbm, czlxbm, xxbm, rhyxbm, 
      xlcdbm, mqzybm, cyzkbm, 
      gzdwmc, ylzffsbm, sjhm, 
      dhhm, lxrxm, lxrdhhm, 
      lxrgxdm, xzz, xzz_probm, 
      xzz_citybm, xzz_areabm, xzz_strbm, 
      xzz_village, xzz_num, jg, 
      jg_probm, jg_citybm, jg_areabm, 
      jg_strbm, blsbm, ycbsbz, 
      ycbsmc, mxbbm, cjqkbm, 
      cjzh, xwwxysbm, cfpfssbz, 
      cfpfssbm, rllxbm, ysbm, 
      csbm, qclbm, jdrq, jdyljgbm, 
      zrysbh, zrysxm, zrysdh, 
      djrq, djrbh, djrxm, 
      dcrq, dczbh, dczxm, 
      update_time,grxgbh,last_doctor_id)
    values (#{userId}, #{yljgbm}, 
      #{jkdabh}, #{yljgmc}, #{zjlx}, 
      #{zjhm}, #{jmjkkh}, #{xm}, #{xbbm}, 
      #{jmlxbm}, #{hyzkbm}, #{csrq}, #{mzbm}, 
      #{gjbm}, #{czlxbm}, #{xxbm}, #{rhyxbm}, 
      #{xlcdbm}, #{mqzybm}, #{cyzkbm}, 
      #{gzdwmc}, #{ylzffsbm}, #{sjhm}, 
      #{dhhm}, #{lxrxm}, #{lxrdhhm}, 
      #{lxrgxdm}, #{xzz}, #{xzzProbm}, 
      #{xzzCitybm}, #{xzzAreabm}, #{xzzStrbm}, 
      #{xzzVillage}, #{xzzNum}, #{jg}, 
      #{jgProbm}, #{jgCitybm}, #{jgAreabm}, 
      #{jgStrbm}, #{blsbm}, #{ycbsbz}, 
      #{ycbsmc}, #{mxbbm}, #{cjqkbm}, 
      #{cjzh}, #{xwwxysbm}, #{cfpfssbz}, 
      #{cfpfssbm}, #{rllxbm}, #{ysbm}, 
      #{csbm}, #{qclbm}, #{jdrq}, #{jdyljgbm}, 
      #{zrysbh}, #{zrysxm}, #{zrysdh}, 
      #{djrq}, #{djrbh}, #{djrxm}, 
      #{dcrq}, #{dczbh}, #{dczxm}, 
      #{updateTime},#{grxgbh},#{lastDoctorId})
  </insert>
  <update id="update" parameterType="org.system.entity.user.healthinfo.HealthInfo" >
    update health_info set  id=#{id} 
    <if test="yljgbm !=null and yljgbm !='' ">
      	,yljgbm = #{yljgbm}
    </if>
    <if test="jkdabh !=null and jkdabh !='' ">
      	,jkdabh = #{jkdabh}
    </if>
    <if test="yljgmc !=null and yljgmc !='' ">
      	,yljgmc = #{yljgmc}
    </if>
    <if test="zjlx !=null and zjlx !='' ">
      	,zjlx = #{zjlx}
    </if>
    <if test="zjhm !=null and zjhm !='' ">
      	,zjhm = #{zjhm}
    </if>
    <if test="jmjkkh !=null and jmjkkh !='' ">
      	,jmjkkh = #{jmjkkh}
    </if>
    <if test="xm !=null and xm !=''">
      	,xm = #{xm}
    </if>
    <if test="xbbm !=null and xbbm !=''">
      	,xbbm = #{xbbm}
    </if>
    <if test="jmlxbm !=null and jmlxbm !=''">
      	,jmlxbm = #{jmlxbm}
    </if>
    <if test="hyzkbm !=null and hyzkbm !=''">
      	,hyzkbm = #{hyzkbm}
    </if>
    <if test="csrq !=null ">
      	,csrq = #{csrq}
    </if>
    <if test="mzbm !=null and mzbm !=''">
      	,mzbm = #{mzbm}
    </if>
    <if test="gjbm !=null and gjbm !=''">
      	,gjbm = #{gjbm}
    </if>
    <if test="czlxbm !=null and czlxbm !=''">
      	,czlxbm = #{czlxbm}
    </if>
    <if test="xxbm !=null and xxbm !=''">
      	,xxbm = #{xxbm}
    </if>
    <if test="rhyxbm !=null and rhyxbm !=''">
      	,rhyxbm = #{rhyxbm}
    </if>
    <if test="xlcdbm !=null and xlcdbm !=''">
      	,xlcdbm = #{xlcdbm}
    </if>
    <if test="mqzybm !=null and mqzybm !=''">
      	,mqzybm = #{mqzybm}
    </if>
    <if test="cyzkbm !=null and cyzkbm !=''">
      	,cyzkbm = #{cyzkbm}
    </if>
    <if test="gzdwmc !=null and gzdwmc !=''">
      	,gzdwmc = #{gzdwmc}
    </if>
    <if test="ylzffsbm !=null and ylzffsbm !=''">
      	,ylzffsbm = #{ylzffsbm}
    </if>
    <if test="sjhm !=null and sjhm !=''">
      	,sjhm = #{sjhm}
    </if>
    <if test="dhhm !=null and dhhm !=''">
      	,dhhm = #{dhhm}
    </if>
    <if test="lxrxm !=null and lxrxm !=''">
      	,lxrxm = #{lxrxm}
    </if>
    <if test="lxrdhhm !=null and lxrdhhm !=''">
      	,lxrdhhm = #{lxrdhhm}
    </if>
    <if test="lxrgxdm !=null and lxrgxdm !=''">
      	,lxrgxdm = #{lxrgxdm}
    </if>
    <if test="xzz !=null and xzz !=''">
      	,xzz = #{xzz}
    </if>
    <if test="xzzProbm !=null and xzzProbm !=''">
      	,xzz_probm = #{xzzProbm}
    </if>
    <if test="xzzCitybm !=null and xzzCitybm !=''">
      	,xzz_citybm = #{xzzCitybm}
    </if>
    <if test="xzzAreabm !=null and xzzAreabm !=''">
      	,xzz_areabm = #{xzzAreabm}
    </if>
    <if test="xzzStrbm !=null and xzzStrbm !=''">
      	,xzz_strbm = #{xzzStrbm}
    </if>
    <if test="xzzVillage !=null and xzzVillage !=''">
      	,xzz_village = #{xzzVillage}
    </if>
    <if test="xzzNum !=null and xzzNum !=''">
      	,xzz_num = #{xzzNum}
    </if>
    <if test="jg !=null and jg !=''">
      	,jg = #{jg}
    </if>
    <if test="jgProbm !=null and jgProbm !=''">
      	,jg_probm = #{jgProbm}
    </if>
    <if test="jgCitybm !=null and jgCitybm !=''">
      	,jg_citybm = #{jgCitybm}
    </if>
    <if test="jgAreabm !=null and jgAreabm !=''">
      	,jg_areabm = #{jgAreabm}
    </if>
    <if test="jgStrbm !=null and jgStrbm !=''">
      	,jg_strbm = #{jgStrbm}
    </if>
    <if test="blsbm !=null and blsbm !=''">
      	,blsbm = #{blsbm}
    </if>
    <if test="ycbsbz !=null and ycbsbz !=''">
      	,ycbsbz = #{ycbsbz}
    </if>
    <if test="ycbsmc !=null and ycbsmc !=''">
      	,ycbsmc = #{ycbsmc}
    </if>
    <if test="mxbbm !=null and mxbbm !=''">
      	,mxbbm = #{mxbbm}
    </if>
    <if test="cjqkbm !=null and cjqkbm !=''">
      	,cjqkbm = #{cjqkbm}
    </if>
    <if test="cjzh !=null and cjzh !=''">
      	,cjzh = #{cjzh}
    </if>
    <if test="xwwxysbm !=null and xwwxysbm !=''">
      	,xwwxysbm = #{xwwxysbm}
    </if>
    <if test="cfpfssbz !=null and cfpfssbz !=''">
      	,cfpfssbz = #{cfpfssbz}
    </if>
    <if test="cfpfssbm !=null and cfpfssbm !=''">
      	,cfpfssbm = #{cfpfssbm}
    </if>
    <if test="rllxbm !=null and rllxbm !=''">
      	,rllxbm = #{rllxbm}
    </if>
    <if test="ysbm !=null and ysbm !=''">
      	,ysbm = #{ysbm}
    </if>
    <if test="csbm !=null and csbm !=''">
      	,csbm = #{csbm}
    </if>
    <if test="qclbm !=null and qclbm !=''">
      	,qclbm = #{qclbm}
    </if>
    <if test="jdrq !=null ">
      	,jdrq = #{jdrq}
    </if>
    <if test="jdyljgbm !=null and jdyljgbm !=''">
      	,jdyljgbm = #{jdyljgbm}
    </if>
    <if test="zrysbh !=null and zrysbh !=''">
      	,zrysbh = #{zrysbh}
    </if>
    <if test="zrysxm !=null and zrysxm !=''">
      	,zrysxm = #{zrysxm}
    </if>
    <if test="zrysdh !=null and zrysdh !=''">
      	,zrysdh = #{zrysdh}
    </if>
    <if test="djrq !=null ">
      	,djrq = #{djrq}
    </if>
    <if test="djrbh !=null and djrbh !=''">
      	,djrbh = #{djrbh}
    </if>
    <if test="djrxm !=null and djrxm !=''">
      	,djrxm = #{djrxm}
    </if>
    <if test="dcrq !=null ">
      	,dcrq = #{dcrq}
    </if>
    <if test="dczbh !=null and dczbh !=''">
      	,dczbh = #{dczbh}
    </if>
    <if test="dczxm !=null and dczxm !=''">
      	,dczxm = #{dczxm}
    </if>
    <if test="grxgbh !=null and grxgbh !=''">
      	,grxgbh = #{grxgbh}
    </if>
    <if test="updateTime !=null ">
      	,update_time = #{updateTime}
    </if>
    <if test=" lastDoctorId !=null ">
      	,last_doctor_id = #{lastDoctorId}
    </if>
    where id = #{id}
  </update>
  <select id="queryOne" resultType="map" parameterType="org.system.entity.user.healthinfo.HealthInfo" >
    select id, user_id userId
    from health_info
    where id = #{id}
  </select>
  <select id="queryAll" parameterType="org.system.entity.user.healthinfo.HealthInfo" resultType="map"  >
   select hi.id, hi.user_id userId,hi.yljgbm,fn_print_hospital_name_result(hi.yljgbm) yljgbmName,hi.jkdabh,hi.yxt_jkdabh yxtJkdabh,hi.yljgmc,hi.zjlx,fn_print_sys_code_result(hi.zjlx,';','CV02.01.101') zjlxName,
		hi.zjhm,hi.jmjkkh,hi.xm, hi.xbbm,fn_print_sys_code_result(hi.xbbm,';','GB2261.1-2003') xbbmName,hi.jmlxbm, fn_print_sys_code_result(hi.jmlxbm,';','jmlxbm') jmlxbmName,
		hi.hyzkbm,fn_print_sys_code_result(hi.hyzkbm,';','GB/T2261.2-2003') hyzkbmName,hi.csrq,hi.mzbm,fn_print_sys_code_result(hi.mzbm,';','GB/T3304-1991') mzbmName,
		hi.gjbm, fn_print_sys_code_result(hi.gjbm,';','GB/T2659-2000') gjbmName,hi.czlxbm,fn_print_sys_code_result(hi.czlxbm,';','czlxbm') czlxbmName,
		hi.xxbm,fn_print_sys_code_result(hi.xxbm,';','CV04.50.005') xxbmName,hi.rhyxbm, fn_print_sys_code_result(hi.rhyxbm,';','rhyxbm') rhyxbmName,
		hi.xlcdbm, fn_print_sys_code_result(hi.xlcdbm,';','GB/T4658-2006') xlcdbmName,hi.mqzybm, fn_print_sys_code_result(hi.mqzybm,';','GB/T6565-2009') mqzybmName,
		hi.cyzkbm, fn_print_sys_code_result(hi.cyzkbm,';','GB/T2261.4-2003') cyzkbmName,hi.gzdwmc,hi.ylzffsbm, fn_print_sys_code_result(hi.ylzffsbm,';','CV07.10.003') ylzffsbmName,
		hi.sjhm,hi.dhhm,hi.lxrxm,hi.lxrdhhm,hi.lxrgxdm, fn_print_sys_code_result(hi.lxrgxdm,';','GB4761-2008') lxrgxdmName,
		hi.xzz, hi.xzz_probm xzzProbm,fn_print_sys_code_result_a(hi.xzz_probm,';','156') xzzProbmName,
		hi.xzz_citybm xzzCitybm,fn_print_sys_code_result(hi.xzz_citybm,';','GB/T2260-2007') xzzCitybmName,hi.xzz_areabm xzzAreabm,fn_print_sys_code_result(hi.xzz_areabm,';','GB/T2260-2007') xzzAreabmName,
		hi.xzz_strbm xzzStrbm, fn_print_sys_code_result(hi.xzz_strbm,';','GB/T2260-2007') xzzStrbmName,hi.xzz_village xzzVillage, 
		hi.xzz_num xzzNum,hi.jg,hi.jg_probm jgProbm,fn_print_sys_code_result_a(hi.jg_probm,';','156') jgProbmName,
		hi.jg_citybm jgCitybm,fn_print_sys_code_result(hi.jg_citybm,';','GB/T2260-2007') jgCitybmName,hi.jg_areabm jgAreabm,fn_print_sys_code_result(hi.jg_areabm,';','GB/T2260-2007') jgAreabmName,
		hi.jg_strbm jgStrbm,fn_print_sys_code_result(hi.jg_strbm,';','GB/T2260-2007') jgStrbmName,hi.blsbm, fn_print_sys_code_result(hi.blsbm,';','CV03.00.301') blsbmName,
		hi.ycbsbz, hi.ycbsmc,hi.mxbbm, fn_print_sys_code_result(hi.mxbbm,';','mxbbm') mxbbmName,hi.cjqkbm, fn_print_sys_code_result(hi.cjqkbm,';','CV05.10.001') cjqkbmName,
		hi.cjzh, hi.xwwxysbm,fn_print_sys_code_result(hi.xwwxysbm,';','xwwxysbm') xwwxysbmName,hi.cfpfssbz,hi.cfpfssbm,fn_print_sys_code_result(hi.cfpfssbm,';','CV03.00.302') cfpfssbmName,
		hi.rllxbm,fn_print_sys_code_result(hi.rllxbm,';','CV03.00.303') rllxbmName,hi.ysbm,fn_print_sys_code_result(hi.ysbm,';','CV03.00.115') ysbmName,
		hi.csbm,fn_print_sys_code_result(hi.csbm,';','CV03.00.304') csbmName,hi.qclbm, fn_print_sys_code_result(hi.qclbm,';','qclbm') qclbmName,
		hi.jdrq, hi.jdyljgbm, fn_print_hospital_name_result(hi.jdyljgbm) jdyljgbmName,hi.zrysbh, hi.zrysxm, hi.zrysdh,hi.djrq, 
		hi.djrbh,hi.djrxm, hi.dcrq,hi.dczbh,hi.dczxm, hi.update_time updateTime,u.wechat_id wechatId,u.register_date registerDate,ud.id_card idCard,ud.`name` userName,
		(DATE_FORMAT(FROM_DAYS(TO_DAYS(NOW())-TO_DAYS(ud.birthday)), '%Y')+0) age,ud.sex,ud.marriage_type  marriageType,ud.contact,u.phone,ud.is_member isMember,hi.grxgbh,fn_print_sys_code_result(hi.grxgbh,';','grxgbh') grxgbhName
	from health_info hi
	left join user u on u.id=hi.user_id
	left join user_detail ud on ud.user_id=u.id
	<where>
		<if test="userId !=null ">
			 hi.user_id=#{userId}
		</if>
	</where>
  </select>
</mapper>