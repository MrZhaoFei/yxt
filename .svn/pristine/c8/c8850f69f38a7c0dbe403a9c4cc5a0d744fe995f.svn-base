<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.system.mapper.service.transfer.YuyueCountInfoMapper" >
	<!-- 修改 -->
	<update id="update" parameterType="org.system.entity.service.transfer.YuyueCountInfo">
		update yuyue_count_info  yyci set 
		<if test=" totalCount !=null ">
				yyci.total_count=#{totalCount}
		</if>
		where yyci.id=#{id}
	</update>
	
	<!-- 查询列表 -->
	<select id="queryAll" parameterType="org.system.entity.service.transfer.YuyueCountInfo" resultType="map">
		select yyci.id,yyci.doctor_id doctorId,yyci.total_count totalCount,yyci.used_count usedCount,ps.`name` serviceName,yyci.yuyue_date yuyueDate,h.`name` hospitalName,d.`name` departmentName
		from yuyue_count_info yyci
		left join department d on d.id=yyci.department_id
		left join hospital h on h.id=yyci.hospital_id
		left join product_service ps on ps.id=yyci.product_service_id
		where  yyci.doctor_id=#{doctorId} and yyci.yuyue_date &gt; #{yuyueDate}
		<if test="productServiceId !=null">
			and yyci.product_service_id=#{productServiceId}
		</if>
	</select>
	
	<!-- 根据主键查询单个 -->
	<select id="queryOne" parameterType="org.system.entity.service.transfer.YuyueCountInfo" resultType="map">
		select yyci.id,yyci.doctor_id doctorId,yyci.total_count totalCount,yyci.used_count usedCount,ps.`name` serviceName,yyci.yuyue_date yuyueDate,h.`name` hospitalName,d.`name` departmentName
		from yuyue_count_info yyci
		left join department d on d.id=yyci.department_id
		left join hospital h on h.id=yyci.hospital_id
		left join product_service ps on ps.id=yyci.product_service_id where yyci.id=#{id}
	</select>
</mapper>