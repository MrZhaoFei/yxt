<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.system.mapper.service.PackageServiceMapper" >

	<!--添加  -->
	  <insert id="insert" parameterType="org.system.mapper.service.PackageServiceMapper"  useGeneratedKeys="true" keyColumn="id" >
	       insert into package_service (service_id,times,price,service_pack_condition_id) values
	           (#{serviceId},#{times}, #{price},#{servicePackConditionId})  
	        
	  </insert>
  
 
	<!-- 删除 -->
	<delete id="delete" parameterType="org.system.mapper.service.PackageServiceMapper">
		DELETE FROM package_service WHERE id=#{id}
	</delete>
	

	<!--查询所有  -->
	<select id="queryAll"  parameterType="org.system.entity.service.PackageService" resultType="map">
	       select psv.id id,psv.price price2,psv.times times,psv.service_id serviceId,psv.service_pack_condition_id serviceConditionId,
	         ps.name productServiceName,ps.price price from product_service ps left join package_service psv on ps.id=psv.service_id 
	   <where>
	      <if test="servicePackConditionId!=null and servicePackConditionId!=''">
	            ps.service_pack_condition_id=#{id}
	      </if>
	   </where>
	  <!--  order  by  psv.id -->
	</select>


	<update id="update" parameterType="org.system.entity.service.PackageService" >
	  update package_service set id=#{id}
	  <if test="serviceId!=null and serviceId!=''">
	    ,service_id=#{serviceId}
	  </if>
	   <if test="price!=null ">
	    ,price=#{price}
	  </if>
	  
	   <if test="times!=null ">
	    ,times=#{times}
	  </if> 
	   <if test="servicePackConditionId!=null and servicePackConditionId!=''">
	    ,service_pack_condition_id=#{servicePackConditionId}
	  </if>
	   where id=#{id}	
	</update>


<select id="queryOne"  parameterType="org.system.entity.service.ServicePack" resultType="map">       
     select psv.id idd,psv.price price2,psv.times times,psv.service_id serviceId,psv.service_pack_condition_id serviceConditionId,
     ps.id productServiceName,ps.price price from product_service ps 
     left join package_service psv on ps.id=psv.service_id 
     where psv.id=#{id}
</select>

		<!-- 根据约束键查询数据是否存在 -->
	<select id="checkExists" parameterType="org.system.mapper.service.PackageServiceMapper" resultType="map">	
	select service_id,times,price,service_pack_condition_id from package_service ps  where ps.service_id=#{serviceId}  and ps.service_pack_condition_id=#{servicePackConditionId}
	</select>

  <!--根据优惠包id值得到已有的产品服务包  -->
	<select id="queryMany" parameterType="org.system.mapper.service.PackageServiceMapper" resultType="map">
		 select ps.id idd,psv.name productServiceName,psv.price price,ps.price price2,ps.times times from package_service ps left join service_pack_condition spc on ps.service_pack_condition_id=spc.id
		 left join product_service psv on psv.id=ps.service_id  
		 where spc.id=#{id}
		 group by ps.id
	 </select> 

</mapper>