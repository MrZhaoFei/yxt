<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.system.mapper.user.UserFollowMapper">
<!-- 新增 -->
<insert id="insert" parameterType="org.system.entity.user.UserFollow">
	insert into user_follow(user_id,follow_id) values
	<foreach collection="followIds" item="id" separator=",">
		(#{userId},#{id})
	</foreach>
</insert>
<!-- 检查唯一性 -->
<select id="checkExistsMany" parameterType="org.system.entity.user.UserFollow" resultType="map">
	select user_id,follow_id from user_follow where user_id=#{userId} and follow_id in 
	<foreach collection="followIds" item="followId" separator="," open="(" close=")">
		#{followId}
	</foreach>
</select>
<!-- 查询列表 -->
<select id="queryAll" parameterType="org.system.entity.user.UserFollow" resultType="map">
	SELECT uf.user_id userId,ud.name userName,uf.follow_id followId,f.name followName FROM user_follow uf 
	left join user_detail ud on ud.user_id=uf.user_id
    left join follow f on f.id=uf.follow_id 
	<where>
		<if test="userId!=null and userId!=''">
			uf.user_id=#{userId}
		</if>
	</where>
</select>
<!-- 删除 -->
<delete id="delete" parameterType="org.system.entity.user.UserFollow">
	delete from user_follow where user_id=#{userId} and follow_id in
	<foreach collection="followIds" item="followId" separator="," open="(" close=")">
		#{followId}
	</foreach>
</delete>
</mapper>