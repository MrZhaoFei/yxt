<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.system.mapper.relation.HospiDepartDoctorRelationMapper" >


<insert id="insert" parameterType="org.system.entity.relation.HospiDepartDoctorRelation" >
     insert into hospi_depart_doctor_relation (hospital_id,department_id,doctor_id) values (#{hospitalId},#{departmentId},#{doctorId})
</insert>


<!-- 检查唯一性 -->
    <select id="checkExists" parameterType="org.system.entity.relation.HospiDepartDoctorRelation" resultType="map">
	     SELECT hospital_id,department_id,doctor_id from hospi_depart_doctor_relation 
	     <where>
	      <if test="hospitalId!=null">
	       hospital_id=#{hospitalId}
	      </if>
	       <if test="departmentId!=null">
	      and department_id=#{departmentId}
	      </if>
	       <if test="doctorId!=null">
	      and doctor_id=#{doctorId} 
	      </if>
	     </where>  
     </select>


<update id="update" parameterType="org.system.entity.relation.HospiDepartDoctorRelation">
   update hospi_depart_doctor_relation
    <set>
      <if test="hospitalId !=null ">
       hospital_id=#{hospitalId}
      </if>
      
       <if test="departmentId !=null ">
       department_id=#{departmentId}
      </if>
    </set>
    	where doctor_id=#{doctorId}
</update>


<select id="queryHospDept" parameterType="org.system.entity.relation.HospiDepartDoctorRelation" resultType="map">
 select d.id doctorID,h.id hospId,dept.id deptId, h.name hosptitalName,dept.name departmentName  from  hospi_depart_doctor_relation hddr left join hospital h on  hddr.hospital_id=h.id
 left join department dept on dept.id =hddr.department_id 
 left join doctor d on d.id=hddr.doctor_id
 where d.id=#{doctorId}
</select>


<delete id="delete"  parameterType="org.system.entity.relation.HospiDepartDoctorRelation" >
       DELETE FROM  hospi_depart_doctor_relation where doctor_id=#{doctorId}
</delete>







</mapper>