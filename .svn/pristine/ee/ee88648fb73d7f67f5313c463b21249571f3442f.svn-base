<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.system.mapper.doctor.DoctorDetailMapper" >

<!-- 新增 -->
<insert id="insert" parameterType="org.system.entity.doctor.DoctorDetail">
 insert into doctor_detail (doctor_id,address_detail,IDCard,name,birthday,photo,school,profile,grade,gootat,zp_hospital_id,zp_department_id) values
  (#{doctorId},#{addressDetail},#{idCard},#{name},#{birthday},#{photo},#{school},#{profile},#{grade},#{gootat},#{zpHospitalId},#{zpDepartmentId})
</insert>

<!-- 修改 -->
<update id="update" parameterType="org.system.entity.doctor.DoctorDetail">
update doctor_detail 
   <set>
   <if test="name !=null and name!=''">
			name=#{name},
		</if>
		<if test="profile !=null and profile!=''">
			profile=#{profile},
		</if>
		<if test="grade !=null and grade!=''">
			grade=#{grade},
		</if>
		<if test="gootat !=null and gootat!=''">
			gootat=#{gootat},
		</if>
		<if test="addressDetail!=null and addressDetail!=''">
		   address_detail=#{addressDetail},
		</if>
		<if test="photo!=null and photo!=''">
		   photo=#{photo},
		</if>		
			<if test="school!=null and school!=''">
		   school=#{school},
		</if>
			<if test="birthday!=null">
		   birthday=date(#{birthday,jdbcType=TIMESTAMP}),
		</if>			
		   zp_hospital_id=#{zpHospitalId},		
		   zp_department_id=#{zpDepartmentId},	
	</set>
	where doctor_id=#{doctorId}
</update>

	<!--删除  -->
		<delete id="delete" parameterType="org.system.entity.doctor.DoctorDetail">
			DELETE FROM doctor_detail WHERE doctor_id=#{doctorId}
		</delete>

	<!-- 查询 -->
	<select id="queryAll" parameterType="org.system.entity.doctor.DoctorDetail"
		resultType="map">
		select
		d.id,dd.doctor_id,dd.IDCard,dd.name,dd.birthday,dd.school,dd.profile,dd.grade,dd.gootat,
		dd.address_detail addressDetail ,dd.photo,
		dd.zp_hospital_id zpHospitalId,dd.zp_department_id zpDepartmentId,h.name
		hName,dept.name deptName
		from doctor d
		left join doctor_detail dd on d.id=dd.doctor_id
		LEFT join hospital h on h.id=dd.zp_hospital_id
		left join department dept on dept.id=dd.zp_department_id
	</select>


 <!-- 查询单个细节 -->
	<select  id="queryOne" parameterType="org.system.entity.doctor.DoctorDetail" resultType="map">
	   select d.id,dd.doctor_id,dd.IDCard,dd.name,dd.birthday,dd.school,dd.profile,dd.grade,dd.gootat, dd.address_detail addressDetail ,dd.photo,
	dd.zp_hospital_id zpHospitalId,dd.zp_department_id zpDepartmentId,h.name hName,dept.name deptName
	from doctor d 
	left join doctor_detail dd  on d.id=dd.doctor_id 
	LEFT join hospital h on h.id=dd.zp_hospital_id
	left join department dept on dept.id=dd.zp_department_id
	 where d.id=#{doctorId}
	</select>

<!--检查是否存在  -->
<select  id="checkExists"  parameterType="org.system.entity.doctor.DoctorDetail" resultType="map">
  select  doctor_id,IDCard ,profile,name,grade,gootat,address_detail,photo,birthday from doctor_detail where IDCard=#{idCard} and profile=#{profile} and grade=#{grade} and
   gootat=#{gootat} and address_detail=#{addressDetail} and photo=#{photo} and  birthday=#{birthday} and name=#{name}
</select>

</mapper>